function uploadFile() {
    const fileInput = document.createElement('input');
    fileInput.type = 'file';
    fileInput.accept = '.pdf,.jpg,.jpeg,.png,.txt,.doc,.docx';
    fileInput.multiple = true;
    
    fileInput.onchange = function(e) {
        const files = e.target.files;
        if (files.length > 0) {
            let message = `üìÅ ${files.length} File(s) Selected:\n\n`;
            
            for(let i = 0; i < files.length; i++) {
                const file = files[i];
                const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
                message += `${i+1}. ${file.name} (${sizeMB} MB)\n`;
                
                // Preview image files
                if(file.type.startsWith('image/')) {
                    previewImage(file);
                }
                
                // Preview PDF
                if(file.type === 'application/pdf') {
                    previewPDF(file);
                }
                
                // Preview text files
                if(file.type === 'text/plain') {
                    previewText(file);
                }
            }
            
            alert(message + "\n‚úÖ Files ready for viewing!");
            addToFileList(files);
        }
    };
    
    fileInput.click();
}

function previewImage(file) {
    const reader = new FileReader();
    reader.onload = function(e) {
        const previewWindow = window.open('', '_blank');
        previewWindow.document.write(`
            <html>
            <head><title>Preview: ${file.name}</title></head>
            <body style="margin:0; background:#222; display:flex; justify-content:center; align-items:center; height:100vh;">
                <img src="${e.target.result}" style="max-width:90%; max-height:90%; border:2px solid white; border-radius:10px;">
                <br>
                <button onclick="window.print()" style="position:fixed; top:20px; right:20px; padding:10px; background:blue; color:white; border:none; border-radius:5px;">Print</button>
                <button onclick="window.close()" style="position:fixed; top:20px; left:20px; padding:10px; background:red; color:white; border:none; border-radius:5px;">Close</button>
            </body>
            </html>
        `);
    };
    reader.readAsDataURL(file);
}

function previewText(file) {
    const reader = new FileReader();
    reader.onload = function(e) {
        const previewWindow = window.open('', '_blank');
        previewWindow.document.write(`
            <html>
            <head><title>Preview: ${file.name}</title>
            <style>
                body { background:#1a1a2e; color:white; padding:20px; font-family:monospace; }
                pre { background:#0f0c29; padding:20px; border-radius:10px; border:1px solid #4361ee; }
            </style></head>
            <body>
                <h2>üìù ${file.name}</h2>
                <pre>${e.target.result}</pre>
                <button onclick="window.close()" style="padding:10px; background:red; color:white; border:none; border-radius:5px;">Close</button>
            </body>
            </html>
        `);
    };
    reader.readAsText(file);
}

function previewPDF(file) {
    const reader = new FileReader();
    reader.onload = function(e) {
        const previewWindow = window.open('', '_blank');
        previewWindow.document.write(`
            <html>
            <head><title>Preview: ${file.name}</title></head>
            <body style="margin:0; height:100vh;">
                <embed src="${e.target.result}" type="application/pdf" width="100%" height="100%">
                <button onclick="window.close()" style="position:fixed; top:10px; right:10px; padding:10px; background:red; color:white; border:none; border-radius:5px;">Close</button>
            </body>
            </html>
        `);
    };
    reader.readAsDataURL(file);
}

function addToFileList(files) {
    const container = document.getElementById('filesContainer');
    
    for(let i = 0; i < files.length; i++) {
        const file = files[i];
        const sizeMB = (file.size / (1024 * 1024)).toFixed(2);
        const date = new Date().toLocaleString();
        const icon = getFileIcon(file.type);
        const color = getFileColor(file.type);
        
        const fileItem = document.createElement('div');
        fileItem.className = 'file-item';
        fileItem.innerHTML = `
            <div>
                <i class="fas ${icon}" style="color:${color}; margin-right:10px; font-size:1.2rem;"></i>
                <strong>${file.name}</strong>
                <div style="color:#a5b4fc; font-size:0.9rem; margin-top:5px">
                    ${sizeMB} MB ‚Ä¢ ${date}
                </div>
            </div>
            <div>
                <button class="action-btn" style="padding:8px 15px; font-size:0.9rem" onclick="viewFile('${file.name}', '${file.type}')">
                    <i class="fas fa-eye"></i> View
                </button>
                <button class="action-btn" style="padding:8px 15px; font-size:0.9rem; background:#2ecc71" onclick="downloadFile('${file.name}')">
                    <i class="fas fa-download"></i> Download
                </button>
            </div>
        `;
        
        container.prepend(fileItem);
    }
}

function getFileIcon(type) {
    if(type.startsWith('image/')) return 'fa-file-image';
    if(type === 'application/pdf') return 'fa-file-pdf';
    if(type === 'text/plain') return 'fa-file-alt';
    if(type.includes('document') || type.includes('word')) return 'fa-file-word';
    return 'fa-file';
}

function getFileColor(type) {
    if(type.startsWith('image/')) return '#4cc9f0';
    if(type === 'application/pdf') return '#f72585';
    if(type === 'text/plain') return '#2ecc71';
    return '#4361ee';
}

function viewFile(filename, filetype) {
    alert(`üîç Viewing: ${filename}\n\nNote: This is a simulation. In a real app, you would view the actual file.\n\nFile Type: ${filetype}`);
}

function downloadFile(filename) {
    alert(`‚¨áÔ∏è Downloading: ${filename}\n\nNote: This is a simulation. In a real app, the file would download.`);
}
